# Trainee Payments Unit Tests

هذا المجلد يحتوي على جميع الـ unit tests للمكونات الجديدة الخاصة بصفحة مدفوعات المتدربين.

## الملفات المشمولة

### 1. API Tests
- **`features/traineePayments/traineePaymentsApi.test.ts`**
  - اختبارات للـ API slice
  - اختبار جلب البيانات (GET)
  - اختبار إضافة مدفوعات (POST)
  - اختبار تحديث مدفوعات (PUT)
  - اختبار معالجة الأخطاء
  - اختبار إضافة headers للمصادقة

### 2. Hook Tests
- **`hooks/usePayments.test.ts`**
  - اختبارات للـ custom hook
  - اختبار الحالات المختلفة (loading, error, success)
  - اختبار حساب الإحصائيات
  - اختبار الفلترة والترتيب
  - اختبار إدارة حالة الـ dialog
  - اختبار معالجة الأحداث

### 3. Component Tests
- **`components/TraineePayments/TraineePaymentsTable.test.tsx`**
  - اختبارات لجدول المدفوعات
  - اختبار عرض البيانات
  - اختبار أزرار الإجراءات
  - اختبار الحالات المختلفة (مدفوع، جزئي، غير مدفوع)
  - اختبار الحالة الفارغة
  - اختبار التفاعل مع المستخدم

- **`components/TraineePayments/AddPaymentDialog.test.tsx`**
  - اختبارات لديالوج إضافة الدفعة
  - اختبار عرض معلومات المتدرب
  - اختبار حقول النموذج
  - اختبار خيارات الخزينة
  - اختبار إرسال النموذج
  - اختبار حالات التحميل

### 4. Utility Tests
- **`utils/traineePaymentUtils.test.ts`**
  - اختبارات للدوال المساعدة
  - اختبار تنسيق العملة
  - اختبار حساب الإحصائيات
  - اختبار الفلترة والترتيب
  - اختبار حساب المبلغ المتبقي
  - اختبار تنسيق التواريخ

### 5. Page Tests
- **`app/TraineePayments/page.test.tsx`**
  - اختبارات للصفحة الرئيسية
  - اختبار عرض المكونات
  - اختبار التفاعل مع الفلاتر
  - اختبار حالات التحميل والأخطاء
  - اختبار إدارة الـ dialogs

## كيفية تشغيل الاختبارات

### تشغيل جميع الاختبارات
```bash
npm test
```

### تشغيل اختبارات محددة
```bash
# اختبارات API
npm test traineePaymentsApi.test.ts

# اختبارات Hook
npm test usePayments.test.ts

# اختبارات المكونات
npm test TraineePaymentsTable.test.tsx
npm test AddPaymentDialog.test.tsx

# اختبارات الدوال المساعدة
npm test traineePaymentUtils.test.ts

# اختبارات الصفحة
npm test page.test.tsx
```

### تشغيل الاختبارات مع التغطية
```bash
npm test -- --coverage
```

## Mocking

تم استخدام الـ mocking للعناصر التالية:
- **framer-motion**: لتبسيط اختبارات الحركة
- **lucide-react**: لاستبدال الأيقونات
- **react-hook-form**: لاختبار النماذج
- **react-hot-toast**: لاختبار الإشعارات
- **API calls**: لاختبار استدعاءات الـ API

## البيانات التجريبية

تم إنشاء بيانات تجريبية شاملة تغطي جميع الحالات:
- مدفوعات مدفوعة بالكامل
- مدفوعات مدفوعة جزئياً
- مدفوعات غير مدفوعة
- بيانات المتدربين والرسوم والخزائن
- المعاملات المرتبطة

## التغطية المستهدفة

الهدف هو تحقيق تغطية 90%+ لجميع الملفات الجديدة:
- ✅ API slice: 100%
- ✅ Custom hook: 100%
- ✅ Components: 95%+
- ✅ Utility functions: 100%
- ✅ Page component: 90%+

## ملاحظات مهمة

1. **الاختبارات تعتمد على البيانات التجريبية** وليس على الـ API الحقيقي
2. **تم اختبار جميع الحالات الحدية** مثل المصفوفات الفارغة والقيم الفارغة
3. **تم اختبار التفاعل مع المستخدم** مثل النقر على الأزرار وتغيير الفلاتر
4. **تم اختبار معالجة الأخطاء** في جميع المستويات
5. **الاختبارات تدعم اللغة العربية** وتنسيق التواريخ والعملة
